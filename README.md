# 碳足迹计算器 - 25-10矿大能动

一个帮助班级同学了解和减少个人碳足迹的Web应用，支持访客模式和登录模式。

## ✨ 核心特性

- **🚀 访客模式** - 无需登录，立即使用
- **📊 双重计算** - 交通方式（12种）+ 食品消费（13种）碳排放对比
- **💾 自动保存** - 计算结果自动保存到本地浏览器
- **👤 登录绑定** - 可选登录，记录绑定到学号账户
- **📈 数据管理** - 管理员查看全班数据和导出CSV
- **🌳 减排建议** - 个性化环保建议和树木吸碳换算

---

## 🎯 最新更新（v2.0 - 2025-11-29）

### 🆕 访客模式
- ✅ **无需登录** - 个人记录页面直接访问，无需注册
- ✅ **自动保存** - 计算结果自动记录到本地
- ✅ **灵活切换** - 随时可以登录绑定到账户

### 📊 数据管理
- ✅ **访客记录** - 独立保存访客的计算记录
- ✅ **用户记录** - 登录用户记录绑定学号和姓名
- ✅ **统一管理** - 管理员查看所有记录（访客+用户）
- ✅ **CSV导出** - 一键导出完整数据用于分析

### 🐛 问题修复
- ✅ 修复 "Cannot set properties of null" 错误
- ✅ 修正高铁排放因子（0.035 → 0.041）
- ✅ 优化交通方式标签和排序

详见：
- [功能更新说明-访客模式.md](功能更新说明-访客模式.md)
- [问题修复说明.md](问题修复说明.md)

---

## 🚀 快速开始

### 1️⃣ 启动服务器

```bash
# 进入项目目录
cd c:/Users/Liverpool/Documents/GitHub/liverpool

# 启动Python HTTP服务器
python -m http.server 8080
```

### 2️⃣ 访问应用

**推荐：访客模式（新用户）**
```
1. 打开浏览器访问: http://localhost:8080/calculator.html
2. 选择交通方式或食品类型
3. 输入数量，点击"开始计算"
4. 查看记录: http://localhost:8080/records.html
```

**可选：登录模式（长期用户）**
```
1. 访问: http://localhost:8080/login.html
2. 输入姓名和学号
3. 登录后在计算器中使用
4. 记录会绑定到您的账户
```

---

## 📱 页面功能

### 🏠 首页（index.html）
- 项目介绍
- 功能导航
- 使用指南

### 🧮 计算器（calculator.html）⭐
**核心功能**：
- 交通方式计算（12种交通工具）
- 食品消费计算（13种食品类型）
- 实时结果展示
- **自动保存记录**

**交通方式**：
- 零排放：步行、骑自行车
- 公共交通：地铁、公交、高铁
- 私人交通：小/中/大型汽车、出租车、摩托车
- 航空：国内/国际航班

**食品类型**：
- 肉类：牛肉、羊肉、猪肉、鸡肉、鱼肉
- 乳蛋：牛奶、鸡蛋
- 主食：米饭、小麦
- 蔬果：番茄、生菜、蔬菜、水果

### 📊 个人记录（records.html）⭐
**访客模式**（无需登录）：
- 查看本地保存的计算记录
- 统计总排放量和平均值
- 蓝色提示框引导登录

**登录模式**：
- 查看绑定到账户的记录
- 显示"XX的碳足迹记录"
- 支持退出登录

### 🏆 班级排名（ranking.html）
- 查看班级同学的碳足迹排名
- 总排放量统计
- 减排量对比

### 🔐 登录页面（login.html）
- 简单登录（姓名+学号）
- 无需密码
- 自动保存登录状态

### 👨‍💼 管理员后台（admin.html）⭐
**登录信息**：
- 用户名：`admin` 或 `teacher`
- 密码：`251025`

**功能**：
- 📊 数据总览（用户数、记录数、总排放量）
- 📋 用户列表（包含访客统计）
- 📥 数据导出（CSV格式）
- 🔍 详细记录查看

---

## 📊 使用对比

| 功能 | 访客模式 | 登录模式 |
|------|---------|---------|
| 是否需要登录 | ❌ 不需要 | ✅ 需要姓名+学号 |
| 记录保存 | ✅ 本地浏览器 | ✅ 绑定账户 |
| 查看历史 | ✅ 可以 | ✅ 可以 |
| 管理员可见 | ✅ 显示"访客" | ✅ 显示姓名学号 |
| 跨设备访问 | ❌ 不支持 | ⚠️ 同浏览器 |
| 适用场景 | 快速体验 | 长期使用 |

---

## 🧪 快速测试

### 测试访客模式
```
1. 访问计算器（不登录）
2. 计算：中型汽车10km vs 地铁10km
3. 预期结果：节约 1.31 kg CO₂e
4. 访问个人记录
5. 应看到：访客模式提示 + 记录表格
```

### 测试登录模式
```
1. 访问登录页面
2. 输入：姓名"测试" 学号"000000"
3. 登录后访问计算器
4. 计算：牛肉1kg vs 鸡肉1kg
5. 预期结果：节约 21.0 kg CO₂e
6. 访问个人记录
7. 应看到："测试的碳足迹记录"
```

### 测试管理员功能
```
1. 访问管理员页面
2. 登录：admin / 251025
3. 应看到：用户统计 + 记录列表
4. 点击导出：下载CSV文件
```

---

## 📁 项目结构

```
liverpool/
├── index.html              # 首页
├── calculator.html         # 计算器（核心功能）⭐
├── records.html            # 个人记录（访客模式）⭐
├── ranking.html            # 班级排名
├── login.html              # 登录页面
├── admin.html              # 管理员后台
├── register.html           # 注册页面
│
├── css/
│   └── styles.css          # 全局样式
│
├── js/
│   ├── constants.js        # 碳排放系数常量
│   ├── utils.js            # 工具函数
│   ├── footprint-calculator.js  # 计算核心
│   └── main.js             # 主逻辑
│
├── test-pages/             # 测试页面目录
│   ├── index.html          # 测试页面索引
│   ├── calculator-fixed.html
│   ├── test-transport.html
│   └── diagnostic.html
│
├── 📚 文档/
│   ├── README.md           # 本文件
│   ├── 功能更新说明-访客模式.md
│   ├── 访客模式快速指南.txt
│   ├── 访客模式实现总结.md
│   ├── 问题修复说明.md
│   ├── 交通数据说明.md
│   ├── 快速开始.md
│   └── ... (其他文档)
```

---

## 💾 数据存储

### LocalStorage 结构
```javascript
{
    // 当前登录用户
    "userInfo": {
        "name": "张三",
        "studentId": "202512345",
        "lastLogin": "2025-11-29T12:00:00.000Z"
    },
    
    // 用户记录（登录后）
    "userRecords": [
        {
            "activityType": "transportation",
            "option1Label": "中型汽车(1.6-2.5L)",
            "option1Amount": 10,
            "option1Emission": 1.72,
            "option2Label": "地铁/轻轨",
            "option2Amount": 10,
            "option2Emission": 0.41,
            "totalEmission": 2.13,
            "savings": 1.31,
            "timestamp": "2025-11-29T12:00:00.000Z",
            "studentId": "202512345",
            "userName": "张三"
        }
    ],
    
    // 访客记录（未登录）
    "guestRecords": [
        // 结构相同，但没有 studentId 和 userName
    ]
}
```

---

## 📊 碳排放数据

### 交通方式（kg CO₂e/km）
| 交通方式 | 排放因子 | 分类 |
|---------|---------|------|
| 步行 | 0.000 | 零排放 |
| 骑自行车 | 0.000 | 零排放 |
| 地铁/轻轨 | 0.041 | 公共交通 ⭐ |
| 高铁/动车 | 0.041 | 公共交通 ⭐ |
| 公交车 | 0.089 | 公共交通 |
| 摩托车 | 0.091 | 私人交通 |
| 小型汽车 | 0.122 | 私人交通 |
| 出租车 | 0.159 | 私人交通 |
| 中型汽车 | 0.172 | 私人交通 |
| 国际航班 | 0.195 | 航空 |
| 大型汽车/SUV | 0.221 | 私人交通 |
| 国内航班 | 0.255 | 航空 |

### 食品消费（kg CO₂e/kg）
| 食品类型 | 排放因子 | 分类 |
|---------|---------|------|
| 生菜 | 0.75 | 蔬菜 ⭐ |
| 水果 | 1.10 | 水果 |
| 番茄 | 1.75 | 蔬菜 |
| 蔬菜 | 2.00 | 蔬菜 |
| 小麦 | 2.50 | 主食 |
| 米饭 | 3.00 | 主食 |
| 牛奶 | 3.00 | 乳制品 |
| 鸡蛋 | 4.80 | 蛋类 |
| 鱼肉 | 5.40 | 肉类 |
| 鸡肉 | 6.00 | 肉类 |
| 猪肉 | 12.00 | 肉类 |
| 羊肉 | 24.50 | 肉类 |
| 牛肉 | 27.00 | 肉类 ⚠️ |

**数据来源**：
- IPCC (政府间气候变化专门委员会)
- 英国DEFRA 2023年温室气体转换因子
- 中国环境科学学会碳排放核算标准

---

## 🛠️ 技术栈

- **前端**：HTML5, CSS3, JavaScript (ES6+)
- **存储**：LocalStorage
- **服务器**：Python HTTP Server（开发）
- **数据格式**：JSON, CSV

---

## 📚 文档导航

| 文档 | 说明 |
|------|------|
| [功能更新说明-访客模式.md](功能更新说明-访客模式.md) | 访客模式完整功能说明 |
| [访客模式快速指南.txt](访客模式快速指南.txt) | 快速参考卡片 |
| [访客模式实现总结.md](访客模式实现总结.md) | 技术实现总结 |
| [问题修复说明.md](问题修复说明.md) | HTML转义问题修复 |
| [交通数据说明.md](交通数据说明.md) | 碳排放数据来源 |
| [快速开始.md](快速开始.md) | 5秒快速上手 |

---

## ⚠️ 注意事项

### 数据安全
- ✅ 数据仅保存在本地浏览器
- ⚠️ 清除浏览器缓存会丢失所有数据
- ⚠️ 不同浏览器数据不共享
- ⚠️ 隐私模式下数据不保存

### 管理员
- 🔐 默认密码：`251025`
- ⚠️ 建议定期更换密码
- 📊 导出数据注意保密
- 🔒 管理后台仅当前会话有效

### 浏览器兼容
- ✅ Chrome 4+
- ✅ Firefox 3.5+
- ✅ Safari 4+
- ✅ Edge 所有版本
- ⚠️ IE 8+ (功能受限)

---

## 🤝 贡献

欢迎提出建议和改进意见！

---

## 📄 许可

本项目仅供教育和学习使用。

---

## 👥 开发团队

**25-10矿大能动** - 低碳能源动力工程专业

---

## 📞 联系方式

如有问题，请联系班级管理员。

---

*最后更新：2025-11-29*  
*版本：v2.0 - 访客模式*  
*状态：✅ 稳定运行*
